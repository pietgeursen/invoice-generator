(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
module.exports=function(e){var t,n=String.prototype.split,l=/()??/.exec("")[1]===e;return t=function(t,r,i){if("[object RegExp]"!==Object.prototype.toString.call(r))return n.call(t,r,i);var o,p,s,c,g=[],u=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.extended?"x":"")+(r.sticky?"y":""),x=0,r=new RegExp(r.source,u+"g");for(t+="",l||(o=new RegExp("^"+r.source+"$(?!\\s)",u)),i=i===e?-1>>>0:i>>>0;(p=r.exec(t))&&(s=p.index+p[0].length,!(s>x&&(g.push(t.slice(x,p.index)),!l&&p.length>1&&p[0].replace(o,function(){for(var t=1;t<arguments.length-2;t++)arguments[t]===e&&(p[t]=e)}),p.length>1&&p.index<t.length&&Array.prototype.push.apply(g,p.slice(1)),c=p[0].length,x=s,g.length>=i)));)r.lastIndex===p.index&&r.lastIndex++;return x===t.length?!c&&r.test("")||g.push(""):g.push(t.slice(x)),g.length>i?g.slice(0,i):g}}();
},{}],2:[function(require,module,exports){
function Array(e,n){function t(e){return f&&!isObservable(e)&&(e=Value(e),e._type="MutantArrayValue"),e}function r(e){return e=t(e),c.push(e),u.push(resolve(e)),p.live&&s.push(o(e)),e}function o(e){return"function"==typeof e?e(p.onUpdate):null}function i(){if(c.forEach(function(e,n){s[n]=o(e)}),n&&n.onListen){var e=n.onListen();"function"==typeof e&&v.push(e)}}function a(){for(s.forEach(tryInvoke),s.length=0;v.length;)tryInvoke(v.pop());n&&n.onUnlisten&&n.onUnlisten()}function l(){var e=!1;return c.forEach(function(n,t){var r=resolve(n);isSame(r,u[t],h)||(u[t]=r,e=!0)}),e}var u=[],c=[],s=[],f=n&&n.fixedIndexing||!1,v=[],h=n&&n.comparer||null,p=LazyWatcher(l,i,a);p.value=u,n&&n.idle&&(p.idle=!0),n&&n.nextTick&&(p.nextTick=!0),e&&e.length&&forEach(e,r);var d=function(e){return e?p.addListener(e):p.getValue()};return addCollectionMethods(d,c),d.push=function(e){var n=null;if(1===arguments.length)n=r(e);else{n=[];for(var t=0;t<arguments.length;t++)n.push(r(arguments[t]))}return p.broadcast(),n},d.put=function(e,n){return n=t(n),c[e]=n,u[e]=resolve(n),p.live&&(tryInvoke(s[e]),s[e]=o(n)),p.broadcast(),n},d.insert=function(e,n){return e=t(e),c.splice(n,0,e),p.live&&s.splice(n,0,o(e)),u.splice(n,0,resolve(e)),p.broadcast(),e},d.pop=function(){var e=c.pop();return p.live&&tryInvoke(s.pop()),u.pop(),p.broadcast(),e},d.shift=function(){var e=c.shift();return p.live&&tryInvoke(s.shift()),u.shift(),p.broadcast(),e},d.clear=function(){s.forEach(tryInvoke),c.length=0,s.length=0,u.length=0,p.broadcast()},d.delete=function(e){d.deleteAt(c.indexOf(e))},d.deleteAt=function(e){e>=0&&e<c.length&&(c.splice(e,1),p.live&&s.splice(e,1).forEach(tryInvoke),u.splice(e,1),p.broadcast())},d.transaction=function(e){p.transaction(d,e)},d.set=function(e){var n=!1;if(f){for(var l=e&&e.length||0,v=0;v<l;v++)isObservable(e[v])?e[v]!==c[v]&&(tryInvoke(s[d]),c[v]=e[v],n=!0,p.live&&(s[v]=o(c[v]))):c[v]&&"MutantArrayValue"===c[v]._type?isSame(c[v](),e[v],h)||(c[v].set(e[v]),n=!0):(tryInvoke(s[d]),c[v]=t(e[v]),n=!0,p.live&&(s[v]=o(c[v])));for(var d=l;d<c.length;d++)tryInvoke(s[d]),n=!0;n&&(s.length=l,c.length=l,u.length=l,p.broadcast())}else a(),c.length=0,s.length=0,u.length=0,forEach(e,r),p.live&&(i(),p.broadcast())},d}function tryInvoke(e){"function"==typeof e&&e()}var Value=require("./value"),LazyWatcher=require("./lib/lazy-watcher"),isSame=require("./lib/is-same"),isObservable=require("./is-observable"),resolve=require("./resolve"),addCollectionMethods=require("./lib/add-collection-methods"),forEach=require("./for-each");module.exports=Array;

},{"./for-each":4,"./is-observable":6,"./lib/add-collection-methods":7,"./lib/is-same":9,"./lib/lazy-watcher":10,"./resolve":16,"./value":19}],3:[function(require,module,exports){
function computed(t,e,i){var s=new ProtoComputed(t,e,i);return s.MutantComputed.bind(s)}function ProtoComputed(t,e,i){Array.isArray(t)||(t=[t]),this.values=[],this.releases=[],this.computedValue=null,this.outputValue=null,this.inner=null,this.updating=!1,this.live=!1,this.lazy=!1,this.initialized=!1,this.listeners=[],this.observables=t,this.lambda=e,this.opts=i,this.comparer=i&&i.comparer||null,this.context=i&&i.context||{},this.boundOnUpdate=this.onUpdate.bind(this),this.boundUpdateNow=this.updateNow.bind(this)}function extendedComputed(t,e){var i=!1,s=!1,n=computed(t,function(){return e()},{onListen:function(){i=s=!0},onUnlisten:function(){i=!1}});return n.checkUpdated=function(){i&&!s||(s=!1,e())},n}var resolve=require("./resolve"),isObservable=require("./is-observable"),isSame=require("./lib/is-same"),onceIdle=require("./once-idle");module.exports=computed,computed.NO_CHANGE={},computed.extended=extendedComputed,ProtoComputed.prototype={MutantComputed:function(t){if(!t)return this.getValue();if("function"!=typeof t)throw new Error("Listeners must be functions.");return this.listeners.push(t),this.listen(),this.removeListener.bind(this,t)},removeListener:function(t){for(var e=0,i=this.listeners.length;e<i;e++)if(this.listeners[e]===t){this.listeners.splice(e,1);break}this.listeners.length||this.unlisten()},listen:function(){if(!this.live){for(var t=0,e=this.observables.length;t<e;t++)isObservable(this.observables[t])&&this.releases.push(this.observables[t](this.boundOnUpdate));if(this.inner&&(this.releaseInner=this.inner(this.onInnerUpdate.bind(this,this.inner))),this.live=!0,this.lazy=!0,this.opts&&this.opts.onListen){var i=this.opts.onListen();"function"==typeof i&&this.releases.push(i)}}},unlisten:function(){if(this.live){for(this.live=!1,this.releaseInner&&(this.releaseInner(),this.releaseInner=null);this.releases.length;)this.releases.pop()();this.opts&&this.opts.onUnlisten&&this.opts.onUnlisten()}},update:function(){for(var t=!1,e=0,i=this.observables.length;e<i;e++){var s=resolve(this.observables[e]);isSame(s,this.values[e],this.comparer)||(t=!0,this.values[e]=s)}if(t||!this.initialized){this.initialized=!0;var n=this.lambda.apply(this.context,this.values);if(n===computed.NO_CHANGE)return!1;if(!isSame(n,this.computedValue,this.comparer))return this.releaseInner&&(this.releaseInner(),this.inner=this.releaseInner=null),this.computedValue=n,isObservable(n)?(this.outputValue=n(),this.inner=n,this.live&&(this.releaseInner=this.inner(this.onInnerUpdate.bind(this,this.inner)))):this.outputValue=this.computedValue,!0}return!1},onUpdate:function(){this.opts&&this.opts.idle?this.updating||(this.updating=!0,onceIdle(this.boundUpdateNow)):this.opts&&this.opts.nextTick?this.updating||(this.updating=!0,setImmediate(this.boundUpdateNow)):this.updateNow()},onInnerUpdate:function(t,e){t===this.inner&&(isSame(e,this.outputValue,this.comparer)||(this.outputValue=e,this.broadcast()))},updateNow:function(){this.updating=!1,this.update()&&this.broadcast()},getValue:function(){return(!this.live||this.lazy||this.updating)&&(this.lazy=!1,this.opts&&this.opts.nextTick&&this.live&&this.lazy?this.onUpdate():this.update(),this.inner&&(this.outputValue=resolve(this.inner))),this.outputValue},broadcast:function(){for(var t=this.listeners.slice(0),e=0,i=t.length;e<i;e++)t[e](this.outputValue)}};

},{"./is-observable":6,"./lib/is-same":9,"./once-idle":15,"./resolve":16}],4:[function(require,module,exports){
var resolve=require("./resolve");module.exports=function(e,r){e&&!e.forEach&&(e=resolve(e)),e&&e.forEach&&e.forEach(r)};

},{"./resolve":16}],5:[function(require,module,exports){
(function (global){
function Element(e,n,t,i,r){!r&&(Array.isArray(i)||isText(i)||isNode(i)||isObservable(i))&&(r=i,i=null),checkWatcher(e),i=i||{};var a=parseTag(t,i,n),o=n?e.createElementNS(n,a.tagName):e.createElement(a.tagName);a.id&&(o.id=a.id),a.classes&&a.classes.length&&(o.className=a.classes.join(" "));var d={targets:new Map,bindings:[]};return caches.set(o,d),applyProperties(o,i,d),null!=r&&appendChild(e,o,d,r),maybeBind(e,o),o}function appendChild(e,n,t,i){if(Array.isArray(i))i.forEach(function(i){appendChild(e,n,t,i)});else if(isObservable(i)){var r=getNodes(e,resolve(i));r.forEach(append,{target:n,document:e}),t.targets.set(i,r),t.bindings.push(new Binding(e,i,t))}else i=getNode(e,i),n.appendChild(i),getRootNode(i)===e&&walk(i,rebind)}function append(e){this.target.appendChild(e),getRootNode(e)===this.document&&walk(e,rebind)}function maybeBind(e,n){bindQueue.push([e,n]),currentlyBinding||(currentlyBinding=!0,setImmediate(flushBindQueue))}function flushBindQueue(){for(currentlyBinding=!1;bindQueue.length;){var e=bindQueue.shift(),n=e[0],t=e[1];getRootNode(t)===n&&walk(t,rebind)}}function checkWatcher(e){!watcher&&global.MutationObserver&&(watcher=new global.MutationObserver(onMutate),watcher.observe(e,{subtree:!0,childList:!0}))}function onMutate(e){e.forEach(handleChange)}function getRootNode(e){for(var n=e;n.parentNode;)n=n.parentNode;return n}function handleChange(e){for(var n=0;n<e.addedNodes.length;n++){var t=e.addedNodes[n];caches.has(t.parentNode)||walk(t,rebind)}for(var n=0;n<e.removedNodes.length;n++){var t=e.removedNodes[n];walk(t,unbind)}}function indexOf(e,n){return Array.prototype.indexOf.call(e,n)}function replace(e,n){for(var t=e[e.length-1].parentNode,i=t.childNodes,r=indexOf(i,e[0]),a=0;a<n.length;a++)i[a+r]!==n[a]&&(i[a+r+1]!==n[a]?(i[a+r]===n[a+1]&&n[a+1]?t.insertBefore(n[a],i[a+r]):i[a+r]?t.insertBefore(n[a],i[a+r]):t.appendChild(n[a]),walk(n[a],rebind)):t.removeChild(i[a+r]));e.filter(function(e){return!~n.indexOf(e)}).forEach(function(e){e.parentNode&&t.removeChild(e),walk(e,unbind)})}function isText(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function isNode(e){return e instanceof global.Node||global.HTMLElement&&e instanceof global.HTMLElement}function getNode(e,n){return null==n?e.createTextNode(""):isText(n)?e.createTextNode(n.toString()):n}function getNodes(e,n){if(Array.isArray(n)){if(n.length){for(var t=[],i=0;i<n.length;i++){var r=n[i];Array.isArray(r)?getNodes(e,r).forEach(push,t):t.push(getNode(e,r))}return t.map(getNode.bind(this,e))}return[getNode(e,null)]}return[getNode(e,n)]}function rebind(e){if(1===e.nodeType){var n=caches.get(e);n&&n.bindings.forEach(invokeBind)}}function unbind(e){if(1===e.nodeType){var n=caches.get(e);n&&n.bindings.forEach(invokeUnbind)}}function invokeBind(e){e.bind()}function invokeUnbind(e){e.unbind()}function push(e){this.push(e)}function resolve(e){return"function"==typeof e?e():e}function Binding(e,n,t){this.document=e,this.obs=n,this.data=t,this.bound=!1,this.update=function(i){var r=t.targets.get(n),a=getNodes(e,i);r&&(replace(r,a),t.targets.set(n,a))},this.release=n(this.update),releaseNextTick(this)}var applyProperties=require("./lib/apply-properties"),isObservable=require("./is-observable"),parseTag=require("./lib/parse-tag"),walk=require("./lib/walk"),watch=require("./watch"),caches=new global.WeakMap,bindQueue=[],currentlyBinding=!1,watcher=null,releaseNextTick=require("./lib/release-next-tick");module.exports=function(e,n,t){return Element(global.document,null,e,n,t)},module.exports.forDocument=function(e,n){return Element.bind(this,e,n)},Binding.prototype={bind:function(){this.bound||(this.release||(this.release=watch(this.obs,this.update)),this.bound=!0)},unbind:function(){this.bound&&(this.bound=!1,releaseNextTick(this))}};
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./is-observable":6,"./lib/apply-properties":8,"./lib/parse-tag":11,"./lib/release-next-tick":12,"./lib/walk":13,"./watch":20}],6:[function(require,module,exports){
function isObservable(e){return"function"==typeof e}module.exports=isObservable;
},{}],7:[function(require,module,exports){
module.exports=function(n,t,e){n.get=function(n){return e&&e(),t[n]},n.getLength=function(n){return e&&e(),t.length},n.includes=function(n){return e&&e(),!!~t.indexOf(n)},n.indexOf=function(n){return e&&e(),t.indexOf(n)},n.forEach=function(n,f){e&&e(),t.slice().forEach(n,f)},n.find=function(n){return e&&e(),t.find(n)}};

},{}],8:[function(require,module,exports){
function applyProperties(e,n,i){var t=Set();e.className&&t.add(e.className);for(var s in n){var r=n[s];if("style"===s){var o=resolve(r);for(var a in o){var l=isObservable(o[a])?o[a]:null;l?i.bindings.push(new Binding(bindStyle,e,l,a)):e.style.setProperty(a,o[a])}}else if("hooks"===s){var o=resolve(r);Array.isArray(o)&&o.forEach(function(n){i.bindings.push(new HookBinding(n,e))})}else if("attributes"===s){var o=resolve(r);for(var a in o){var u=isObservable(o[a])?o[a]:null;u?i.bindings.push(new Binding(bindAttr,e,u,a)):e.setAttribute(a,o[a])}}else if("events"===s)for(var b in r)e.addEventListener(b,r[b],!1);else if("ev-"===s.slice(0,3))e.addEventListener(s.slice(3),r,!1);else if("className"===s||"classList"===s)Array.isArray(r)?r.forEach(function(e){t.add(e)}):t.add(r);else{e[s]=resolve(r);var d=isObservable(r)?r:null;d&&i.bindings.push(new Binding(bind,e,d,s))}}containsObservables(t)?i.bindings.push(new Binding(bindClassList,e,t,"className")):e.className=t().join(" ")}function containsObservables(e){for(var n=0,i=e.getLength();n<i;n++)if(isObservable(e.get(n)))return!0}function bindClassList(e,n,i){return watch(n,function(n){n=[].concat.apply([],n).filter(present).join(" "),(n||e[i])&&(e[i]=n)})}function bindStyle(e,n,i){return watch(n,function(n){e.style.setProperty(i,n)})}function bindAttr(e,n,i){return watch(n,function(n){null==n?e.removeAttribute(i):e.setAttribute(i,n)})}function bind(e,n,i){return watch(n,function(n){var t=e[i];t!==n&&(e[i]=n)})}function present(e){return null!=e}function resolve(e){return"function"==typeof e?e():e}function Binding(e,n,i,t){this.element=n,this.source=i,this.key=t,this.fn=e,this.bound=!1}function HookBinding(e,n){this.element=n,this.fn=e,this.bound=!1}var isObservable=require("../is-observable"),Set=require("../set"),watch=require("../watch");module.exports=applyProperties,Binding.prototype={bind:function(){this.bound||(this._release=this.fn(this.element,this.source,this.key),this.bound=!0)},unbind:function(){this.bound&&(this._release(),this._release=null,this.bound=!1)}},HookBinding.prototype={bind:function(){this.bound||(this._release=this.fn(this.element),this.bound=!0)},unbind:function(){this.bound&&"function"==typeof this._release&&(this._release(),this._release=null,this.bound=!1)}};

},{"../is-observable":6,"../set":17,"../watch":20}],9:[function(require,module,exports){
module.exports=function(e,o,t){return!(!t||!t(e,o))||typeof e==typeof o&&("object"!=typeof e||null===e)&&e===o};

},{}],10:[function(require,module,exports){
var onceIdle=require("../once-idle");module.exports=function(e,n,t){function i(){if(!l.suspended)for(var e=l.listeners.slice(0),n=0,t=e.length;n<t;n++)e[n](l.value)}var s=!1,a=this,d=!1,l={live:!1,nextTick:!1,idle:!1,suspended:!1,update:e,value:null,listeners:[],broadcast:function(){l.nextTick?d||(d=!0,setImmediate(i)):i()},transaction:function(e,n){var t=l.suspended;l.suspended=!0,n(e),l.suspended=t,l.broadcast()},onUpdate:function(){l.idle?d||(d=!0,onceIdle(l.updateAndBroadcast)):l.nextTick?d||(d=!0,setImmediate(l.updateAndBroadcast)):l.updateAndBroadcast()},updateAndBroadcast:function(){d=!1,e.call(a)&&i()},checkUpdated:function(){(!l.live||s||d)&&(s=!1,l.nextTick&&l.live&&s?l.onUpdate():e.apply(a))},getValue:function(){return l.checkUpdated.apply(a),l.value},addListener:function(e){if("function"!=typeof e)throw new Error("Listeners must be functions.");return l.listeners.push(e),l.live||(l.live=!0,s=!0,n.apply(a)),function(){for(var n=0,i=l.listeners.length;n<i;n++)if(l.listeners[n]===e){l.listeners.splice(n,1);break}!l.listeners.length&&l.live&&(l.live=!1,t.apply(a))}}};return l};

},{"../once-idle":15}],11:[function(require,module,exports){
"use strict";function parseTag(s,t,r){var e=!t.hasOwnProperty("id"),a=split(s,classIdSplit),l=null;(classOrId.test(a[1])||mcssClass.test(a[1]))&&(l="div");var p,i,n,u,c;for(u=0;u<a.length;u++)i=a[u],i&&(n=i.charAt(0),mcssClass.test(i)?(p=p||[],p.push(i)):l?"."===n?(p=p||[],p.push(i.substring(1,i.length))):"#"===n&&e&&(c=i.substring(1,i.length)):l=i);return{tagName:r?l:l.toUpperCase(),classes:p,id:c}}function isUpperCase(s){if("string"==typeof s&&s)return s.toUpperCase()===s}var split=require("browser-split"),classIdSplit=/([\.#]?[a-zA-Z0-9\u007F-\uFFFF_:-]+)/,classOrId=/^(\.|#)/,mcssClass=/^(\-|[A-Z])/;module.exports=parseTag;

},{"browser-split":1}],12:[function(require,module,exports){
function flush(){for(;queue.length;){var e=queue.pop();e.bound||"function"!=typeof e.release||(e.release(),e.release=null)}}var queue=[];module.exports=function(e){0===queue.length&&setImmediate(flush),queue.push(e)};

},{}],13:[function(require,module,exports){
function nextNode(e,n){for(var o=e.firstChild;e&&!o&&e!==n;)o=e.nextSibling,e=e.parentNode;return o}module.exports=function(e,n){for(var o=e;o;)n(o),o=nextNode(o,e)};

},{}],14:[function(require,module,exports){
(function (global){
function Map(e,n,t){function r(){if("function"==typeof e&&L.push(e(E.onUpdate)),m(),Array.from(w.values()).forEach(function(e){e.forEach(function(e){e.release=e.observable(d.bind(null,e))})}),t&&t.onListen){var n=t.onListen();"function"==typeof n&&L.push(n)}}function o(){for(;L.length;)L.pop()();m(),Array.from(w.values()).forEach(function(e){e.forEach(invokeRelease)}),t&&t.onUnlisten&&t.onUnlisten()}function i(){var n=!1;A.length!==getLength(e)&&(n=!0);for(var t=Date.now(),r=0,o=getLength(e);r<o;r++){var i=get(e,r),u=A[r];A[r]=i,(!isSame(i,u,y)||!E.live&&a(i))&&(S&&Date.now()-t>S?l(r):g(r),n=!0)}if(n){var f=T.length,c=getLength(e);Array.from(k.keys()).filter(notIncluded,e).forEach(s),A.length=c,I.length=c,T.length=c;for(var d=c;d<f;d++)v(d);Array.from(x.values()).filter(notIncluded,T).forEach(h)}return n}function a(e){if(w.has(e))return w.get(e).some(function(e){return k.delete(e.item),!isSame(e.currentValue,resolve(e.observable),y)})}function l(e){R.length||b(u),~R.indexOf(e)||R.push(e)}function u(){for(var e=Date.now();R.length&&(!S||Date.now()-e<S);)g(R.shift());E.broadcast(),R.length&&b(u)}function f(e,n){w.has(e)||w.set(e,[]);var t=w.get(e),r={currentValue:resolve(n),observable:n,item:e,release:null};t.push(r),E.live&&(r.release=r.observable(d.bind(null,r)))}function c(e){return f.bind(null,e)}function s(e){k.delete(e),w.has(e)&&(w.get(e).forEach(invokeRelease),w.delete(e))}function h(e){x.delete(e),t&&t.onRemove&&t.onRemove(e)}function d(n){var t=[],r=getLength(e);k.delete(n.item);for(var o=0;o<r;o++)get(e,o)===n.item&&t.push(o);if(t.length){var i=T[t[0]];t.forEach(function(e){T[e]=null}),T.includes(i)||h(i),t.forEach(g),E.broadcast()}}function g(t){if(t<getLength(e)){var r=get(e,t);if(k.has(r)&&isSame(r,r,y))T[t]=k.get(r);else{w.has(r)&&(w.get(r).forEach(invokeRelease),w.delete(r));var o=n(r,c(r));o!==T[t]&&(T[t]=o),x.add(o),k.set(r,T[t])}v(t),I[t]=resolve(T[t])}}function v(e){M[e]&&(M[e](),M[e]=null),E.live&&"function"==typeof T[e]&&(M[e]=p(T[e],e))}function m(){for(var e=0;e<T.length;e++)v(e)}function p(e,n){return e(function(e){isSame(I[n],e,y)||(I[n]=e,E.broadcast())})}function b(e){t.idle?onceIdle(e):t.delayTime?setTimeout(e,t.delayTime):setImmediate(e)}if("function"!=typeof n)throw new Error("mutant/map lambda must be a function");var y=t&&t.comparer||null,L=[],E=LazyWatcher(i,r,o);t&&t.nextTick&&(E.nextTick=!0),t&&t.idle&&(E.idle=!0);var w=new global.Map,k=new global.Map,x=new global.Set,A=[],T=[],I=[],M=[];E.value=I;var R=[],S=null;t&&t.maxTime&&(S=t.maxTime);var q=function(e){return e?E.addListener(e):E.getValue()};return addCollectionMethods(q,T,E.checkUpdated),q}function get(e,n){return"function"!=typeof e||e.get||(e=e()),Array.isArray(e)?e[n]:e&&e.get?e.get(n):void 0}function getLength(e){return"function"!=typeof e||e.getLength||(e=e()),Array.isArray(e)?e.length:e&&e.get?e.getLength():0}function notIncluded(e){if(this.includes)return!this.includes(e);if(this.indexOf)return!~this.indexOf(e);if("function"==typeof this){var n=this();if(n&&n.includes)return!n.includes(e)}return!0}function invokeRelease(e){e.release&&(e.release(),e.release=null)}var resolve=require("./resolve"),LazyWatcher=require("./lib/lazy-watcher"),isSame=require("./lib/is-same"),addCollectionMethods=require("./lib/add-collection-methods"),onceIdle=require("./once-idle");module.exports=Map;

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./lib/add-collection-methods":7,"./lib/is-same":9,"./lib/lazy-watcher":10,"./once-idle":15,"./resolve":16}],15:[function(require,module,exports){
function flush(){for(var n=Date.now();queue.length&&Date.now()-n<max;)queue.shift()();queue.length?window.requestIdleCallback(flush):running=!1}var queue=[],running=!1,max=1e3/60;module.exports=function(n){if("function"!=typeof n)throw new Error("Must be a function");queue.push(n),running||(running=!0,window.requestIdleCallback(flush))};

},{}],16:[function(require,module,exports){
function resolve(e){return"function"==typeof e?e():e}module.exports=resolve;

},{}],17:[function(require,module,exports){
function Set(e,t){var o=new ProtoSet(e,t),n=o.MutantSet.bind(o);return n.add=o.add.bind(o),n.clear=o.clear.bind(o),n.delete=o.delete.bind(o),n.has=o.has.bind(o),n.set=o.set.bind(o),n.get=o.get.bind(o),n.getLength=o.getLength.bind(o),n}function ProtoSet(e,t){var o=this;o.object=[],o.sources=[],o.releases=[],o.binder=LazyWatcher.call(o,o._update,o._listen,o._unlisten),o.binder.value=this.object,t&&t.nextTick&&(o.binder.nextTick=!0),t&&t.idle&&(o.binder.idle=!0),e&&e.length&&(e.forEach(function(e){~o.sources.indexOf(e)||o.sources.push(e)}),this._update())}function get(e){return e}function resolve(e){return"function"==typeof e?e():e}function notIncluded(e){return!~this.indexOf(e)}function removeFrom(e){var t=this.indexOf(e);~t&&this.splice(t,1)}function addTo(e){this.push(e)}function tryInvoke(e){"function"==typeof e&&e()}var LazyWatcher=require("./lib/lazy-watcher");module.exports=Set,ProtoSet.prototype.MutantSet=function(e){return e?this.binder.addListener(e):this.binder.getValue()},ProtoSet.prototype.add=function(e){~this.sources.indexOf(e)||(this.sources.push(e),this.binder.live&&(this.releases[this.sources.length-1]=this._bind(e)),this.binder.onUpdate())},ProtoSet.prototype.clear=function(){this.releases.forEach(tryInvoke),this.sources.length=0,this.releases.length=0,this.binder.onUpdate()},ProtoSet.prototype.delete=function(e){var t=this.sources.indexOf(e);~t&&(this.sources.splice(t,1),this.releases.splice(t,1).forEach(tryInvoke),this.binder.onUpdate())},ProtoSet.prototype.has=function(e){return!!~this.object.indexOf(e)},ProtoSet.prototype.set=function(e){var t=this,o=!1;if(Array.isArray(e)){for(var n=this.sources.length-1;n>=0;n-=1)~e.indexOf(this.sources[n])||(o=!0,t.sources.splice(n,1));e.forEach(function(e){~t.sources.indexOf(e)||(o=!0,t.sources.push(e))})}else t.sources.length>0&&(t.sources.length=0,o=!0);o&&t.binder.onUpdate()},ProtoSet.prototype.get=function(e){return this.sources[e]},ProtoSet.prototype.getLength=function(){return this.sources.length},ProtoSet.prototype._bind=function(e){return"function"==typeof e?e(this.binder.onUpdate):null},ProtoSet.prototype._listen=function(){var e=this;e.sources.forEach(function(t,o){e.releases[o]=e._bind(t)})},ProtoSet.prototype._unlisten=function(){this.releases.forEach(tryInvoke),this.releases.length=0},ProtoSet.prototype._update=function(){var e=this.object.map(get),t=this.sources.map(resolve);return e.filter(notIncluded,t).forEach(removeFrom,this.object),t.filter(notIncluded,e).forEach(addTo,this.object),!0};

},{"./lib/lazy-watcher":10}],18:[function(require,module,exports){
function Struct(e,t){function n(){f.map(function(e){var t=s[e];i.push(t(function(t){isSame(t,c[e],u)||(c[e]=t,l||o.broadcast(c))}))})}function r(){for(;i.length;)i.pop()()}function a(){var e=!1;return f.forEach(function(t){var n=s[t]();isSame(n,c[t],u)||(c[t]=s[t](),e=!0)}),e}var c=Object.create({}),i=[],o=LazyWatcher(a,n,r);o.value=c,t&&t.nextTick&&(o.nextTick=!0),t&&t.idle&&(o.idle=!0);var u=t&&t.comparer||null,s=function(e){return e?o.addListener(e):o.getValue()},f=Object.keys(e),l=!1;return f.forEach(function(t){if(blackList.hasOwnProperty(t))throw new Error("Cannot create a struct with a key named '"+t+"'.\n"+blackList[t]);var n="function"==typeof e[t]?e[t]:Value(e[t]);c[t]=n(),s[t]=n}),s.set=function(t,n){var r=l;l=!0,t=t||{},n&&n.merge&&(t=extend(c,t)),f.forEach(function(e){s[e]()!==t[e]&&s[e].set(t[e])}),Object.keys(t).forEach(function(n){n in e||(c[n]=t[n])}),l=r,l||o.broadcast()},s}var Value=require("./value"),LazyWatcher=require("./lib/lazy-watcher"),isSame=require("./lib/is-same"),extend=require("xtend");module.exports=Struct;var blackList={length:"Clashes with `Function.prototype.length`.\n",name:"Clashes with `Function.prototype.name`\n",set:"`set` is a reserved key of struct\n"};

},{"./lib/is-same":9,"./lib/lazy-watcher":10,"./value":19,"xtend":24}],19:[function(require,module,exports){
function Observable(e,n){function t(n){if(!n)return e;if("function"!=typeof n)throw new Error("Listeners must be functions.");return u.push(n),function(){for(var e=0,t=u.length;e<t;e++)if(u[e]===n){u.splice(e,1);break}}}var u=[];return e=getValue(e,n),t.set=function(t){e=getValue(t,n);for(var r=u.slice(0),l=0,f=r.length;l<f;l++)r[l](e)},t}function getValue(e,n){return null==e&&(e=n&&null!=n.defaultValue?n.defaultValue:null),e}module.exports=Observable;

},{}],20:[function(require,module,exports){
function watch(o,n){if(n=n||noop,"function"==typeof o){var t=o(n);return n(o()),t}return n(o),noop}function noop(){}module.exports=watch;

},{}],21:[function(require,module,exports){
function When(e,r,n){return r=handleInnerValues(r),n=handleInnerValues(n),computed([e,r,n],lambda)}function lambda(e,r,n){return e?r:n}function handleInnerValues(e){if(Array.isArray(e)&&e.some(isObservable)){var r=[];return computed(e,function(){for(var e=0;e<arguments.length;e++)r[e]=arguments[e];return r.length=arguments.length,r})}return e}var computed=require("./computed"),isObservable=require("./is-observable");module.exports=When;

},{"./computed":3,"./is-observable":6}],22:[function(require,module,exports){
function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(cachedSetTimeout===setTimeout)return setTimeout(e,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(e,0);try{return cachedSetTimeout(e,0)}catch(t){try{return cachedSetTimeout.call(null,e,0)}catch(t){return cachedSetTimeout.call(this,e,0)}}}function runClearTimeout(e){if(cachedClearTimeout===clearTimeout)return clearTimeout(e);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(e);try{return cachedClearTimeout(e)}catch(t){try{return cachedClearTimeout.call(null,e)}catch(t){return cachedClearTimeout.call(this,e)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var e=runTimeout(cleanUpNextTick);draining=!0;for(var t=queue.length;t;){for(currentQueue=queue,queue=[];++queueIndex<t;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,t=queue.length}currentQueue=null,draining=!1,runClearTimeout(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}var process=module.exports={},cachedSetTimeout,cachedClearTimeout;!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var queue=[],draining=!1,currentQueue,queueIndex=-1;process.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var u=1;u<arguments.length;u++)t[u-1]=arguments[u];queue.push(new Item(e,t)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};

},{}],23:[function(require,module,exports){
(function (process,global){
!function(e,t){"use strict";function n(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var a={callback:e,args:t};return m[g]=a,d(g),g++}function a(e){delete m[e]}function s(e){var n=e.callback,a=e.args;switch(a.length){case 0:n();break;case 1:n(a[0]);break;case 2:n(a[0],a[1]);break;case 3:n(a[0],a[1],a[2]);break;default:n.apply(t,a)}}function o(e){if(p)setTimeout(o,0,e);else{var t=m[e];if(t){p=!0;try{s(t)}finally{a(e),p=!1}}}}function c(){d=function(e){process.nextTick(function(){o(e)})}}function i(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}function r(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&o(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),d=function(n){e.postMessage(t+n,"*")}}function f(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;o(t)},d=function(t){e.port2.postMessage(t)}}function u(){var e=h.documentElement;d=function(t){var n=h.createElement("script");n.onreadystatechange=function(){o(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function l(){d=function(e){setTimeout(o,0,e)}}if(!e.setImmediate){var d,g=1,m={},p=!1,h=e.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(e);v=v&&v.setTimeout?v:e,"[object process]"==={}.toString.call(e.process)?c():i()?r():e.MessageChannel?f():h&&"onreadystatechange"in h.createElement("script")?u():l(),v.setImmediate=n,v.clearImmediate=a}}("undefined"==typeof self?"undefined"==typeof global?this:global:self);

}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"_process":22}],24:[function(require,module,exports){
function extend(){for(var r={},e=0;e<arguments.length;e++){var t=arguments[e];for(var n in t)hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty;
},{}],25:[function(require,module,exports){
"use strict";function stateToObservable(t){var e=MutantArray(t.lineItems.map(Struct)),i=Struct(t.user),n=Object.assign({},t,{lineItems:e,user:i});return Struct(n)}function Item(t){var e=t||{description:"",qty:0,price:0,isEditing:Value(!0)};return Struct(e)}function mutator(t,e){e.type}function dispatch(t){mutator(state,t)}function renderEditingItem(t,e){return h("div.item",{},[h("input.fl.w-30",{value:t.description,"ev-change":function(e){return t.description.set(e.target.value)}}),h("input.fl.w-20.tr",{value:t.qty,"ev-change":function(e){return t.qty.set(e.target.value)}}),h("input.fl.w-20.tr",{value:t.price,"ev-change":function(e){return t.price.set(e.target.value)}}),h("div.fl.w-20.tr",{},lineTotal(t)),h("button.fr",{"ev-click":function(){return t.isEditing.set(!1)}},"Done"),h("button.fr",{"ev-click":function(){e.delete(t)}},"Remove"),h("button.fr",{"ev-click":function(){return e.push(Item())}},"Add")])}function renderItem(t){return h("div.item",{"ev-click":function(){return t.isEditing.set(!0)}},[h("div.fl.w-30",{},t.description),h("div.fl.w-20.tr",{},t.qty),h("div.fl.w-20.tr",{},["$",t.price]),h("div.fl.w-20.tr",{},["$",lineTotal(t)])])}function render(t,e){return h("div#app.ph4",{},[h("div#title.pv4",{},[h("div.f1",{},t.user.userName)]),h("div#header",{},[h("div.fl.w-25",{},[h("div",{},["Invoice #",t.invoiceNumber]),h("div",{},t.date),h("div",{},["GST: ",t.user.gst])]),h("div.fl.w-75",{},[h("div.f2.tr",{},"Invoice"),h("div.f3.tr",{},t.client.clientName)])]),h("div#items.pt6",{},[h("div.fl.w-30.f3",{},"Description"),h("div.fl.w-20.f3.tr",{},"Qty"),h("div.fl.w-20.f3.tr",{},"Price"),h("div.fl.w-20.f3.tr",{},"Total"),h("div.pt4",{},MutantMap(t.lineItems,function(e){return console.log("mapping on item.editing:",e.isEditing),when(e.isEditing,renderEditingItem(e,t.lineItems),renderItem(e))},{onRemove:function(t){return console.log("onRemove with:",t())}}))]),h("div#totals.pt5.fr",{},[h("div",{},subtotal),h("div",{},gst),h("div",{},total)])])}require("setimmediate");var h=require("mutant/html-element"),Struct=require("mutant/struct"),computed=require("mutant/computed"),MutantArray=require("mutant/array"),MutantMap=require("mutant/map"),Value=require("mutant/value"),when=require("mutant/when"),initialstate={title:"Counter MUTANT",invoiceNumber:38,date:"4 December 2016",user:{userName:"Piet Geursen",bankAccount:"38-900103434343",phone:"+64274243",gst:"71-590-",address:"",email:""},client:{clientName:"Enspiral Dev Academy",address:""},lineItems:[{description:"teaching work",qty:10,price:3,isEditing:!1},{description:"being kewl",qty:2,price:3,isEditing:!0}]},state=stateToObservable(initialstate),subtotal=computed([state.lineItems],function(t){return t.reduce(function(t,e){return t+e.qty*e.price},0).toFixed(2)}),gst=computed([subtotal],function(t){return(.15*t).toFixed(2)}),total=computed([subtotal],function(t){return(1.15*t).toFixed(2)}),lineTotal=function(t){return computed([t],function(t){return(t.qty*t.price).toFixed(2)})},app=render(state,dispatch),main=document.querySelector("main");main.appendChild(app);

},{"mutant/array":2,"mutant/computed":3,"mutant/html-element":5,"mutant/map":14,"mutant/struct":18,"mutant/value":19,"mutant/when":21,"setimmediate":23}]},{},[25]);
